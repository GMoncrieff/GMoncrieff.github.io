<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

  <!--radix_placeholder_meta_tags-->
  <title>ADVI vs MCMC</title>
  
  <meta property="description" itemprop="description" content="Comparing the performance of models fitted to vegetation postfire recovery data using ADVI and MCMC"/>
  
  
  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2020-08-11"/>
  <meta property="article:created" itemprop="dateCreated" content="2020-08-11"/>
  <meta name="article:author" content="Glenn Moncrieff"/>
  
  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="ADVI vs MCMC"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Comparing the performance of models fitted to vegetation postfire recovery data using ADVI and MCMC"/>
  <meta property="og:locale" content="en_US"/>
  
  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="ADVI vs MCMC"/>
  <meta property="twitter:description" content="Comparing the performance of models fitted to vegetation postfire recovery data using ADVI and MCMC"/>
  
  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Near-real time forecasting and change detection for an open ecosystem with complex natural dynamics;citation_publication_date=2020;citation_volume=166;citation_doi=10.1016/j.isprsjprs.2020.05.017;citation_issn=0924-2716;citation_author=Jasper A. Slingsby;citation_author=Glenn R. Moncrieff;citation_author=Adam M. Wilson"/>
  <meta name="citation_reference" content="citation_title=Climatic controls on ecosystem resilience: Postfire regeneration in the Cape Floristic Region of South Africa.;citation_publication_date=2015;citation_volume=112;citation_doi=10.1073/pnas.1416710112;citation_issn=1091-6490 (Electronic);citation_author=Adam M Wilson;citation_author=Andrew M Latimer;citation_author=John A Jr Silander"/>
  <!--radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","slug","categories","editor_options","output","bibliography","preview"]}},"value":[{"type":"character","attributes":{},"value":["ADVI vs MCMC"]},{"type":"character","attributes":{},"value":["Comparing the performance of models fitted to vegetation postfire recovery data using ADVI and MCMC\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Glenn Moncrieff"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":[]}},"value":[]}]}]},{"type":"character","attributes":{},"value":["08-11-2020"]},{"type":"character","attributes":{},"value":["advi-vs-mcmc"]},{"type":"character","attributes":{},"value":["Bayesian","Fire recovery"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["chunk_output_type"]}},"value":[{"type":"character","attributes":{},"value":["console"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"character","attributes":{},"value":["export-data.bib"]},{"type":"character","attributes":{},"value":["mcmc_vs_advi.png"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["advi-vs-mcmc_files/bowser-1.9.3/bowser.min.js","advi-vs-mcmc_files/distill-2.2.21/template.v2.js","advi-vs-mcmc_files/figure-html5/mcmc_check-1.png","advi-vs-mcmc_files/figure-html5/mcmc_check2-1.png","advi-vs-mcmc_files/figure-html5/p1-1.png","advi-vs-mcmc_files/figure-html5/p2-1.png","advi-vs-mcmc_files/figure-html5/p3-1.png","advi-vs-mcmc_files/figure-html5/plot-1.png","advi-vs-mcmc_files/jquery-1.11.3/jquery.min.js","advi-vs-mcmc_files/webcomponents-2.0.0/webcomponents.js","export-data.bib","firemodel_predict","firemodel_predict.stan","fitmcmc.RDS","fitvb.RDS","IMG_7750.jpeg","mcmc_vs_advi.png","pdata.RDS","postfire.csv"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->
  
  <style type="text/css">
  
  body {
    background-color: white;
  }
  
  .pandoc-table {
    width: 100%;
  }
  
  .pandoc-table>caption {
    margin-bottom: 10px;
  }
  
  .pandoc-table th:not([align]) {
    text-align: left;
  }
  
  .pagedtable-footer {
    font-size: 15px;
  }
  
  .html-widget {
    margin-bottom: 2.0em;
  }
  
  .l-screen-inset {
    padding-right: 16px;
  }
  
  .l-screen .caption {
    margin-left: 10px;
  }
  
  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .shaded .shaded-content {
    background: white;
  }
  
  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }
  
  .hidden {
    display: none !important;
  }
  
  d-article {
    padding-bottom: 30px;
  }
  
  d-appendix {
    padding-top: 30px;
  }
  
  d-article>p>img {
    width: 100%;
  }
  
  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }
  
  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }
  
  /* CSS for table of contents */
  
  .d-toc {
    color: rgba(0,0,0,0.8);
    font-size: 0.8em;
    line-height: 1em;
  }
  
  .d-toc-header {
    font-size: 0.6rem;
    font-weight: 400;
    color: rgba(0, 0, 0, 0.5);
    text-transform: uppercase;
    margin-top: 0;
    margin-bottom: 1.3em;
  }
  
  .d-toc a {
    border-bottom: none;
  }
  
  .d-toc ul {
    padding-left: 0;
  }
  
  .d-toc li>ul {
    padding-top: 0.8em;
    padding-left: 16px;
    margin-bottom: 0.6em;
  }
  
  .d-toc ul,
  .d-toc li {
    list-style-type: none;
  }
  
  .d-toc li {
    margin-bottom: 0.9em;
  }
  
  .d-toc-separator {
    margin-top: 20px;
    margin-bottom: 2em;
  }
  
  .d-article-with-toc {
    border-top: none;
    padding-top: 0;
  }
  
  
  
  /* Tweak code blocks (note that this CSS is repeated above in an injection
     into the d-code shadow dom) */
  
  d-code {
    overflow-x: auto !important;
  }
  
  pre.d-code code.d-code {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }
  
  pre.text-output {
  
    font-size: 12px;
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
  
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
  
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }
  
  @media(min-width: 768px) {
  
  d-code {
    overflow-x: visible !important;
  }
  
  pre.d-code code.d-code  {
      padding-left: 18px;
      font-size: 14px;
  }
  pre.text-output {
    font-size: 14px;
  }
  }
  
  /* Figure */
  
  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }
  
  .figure img {
    width: 100%;
  }
  
  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }
  
  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }
  
  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }
  
  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }
  
  
  
  /* Tweak 1000px media break to show more text */
  
  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }
  
    .grid {
      grid-column-gap: 16px;
    }
  
    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }
  
  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }
  
    .grid {
      grid-column-gap: 32px;
    }
  }
  
  
  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */
  
  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }
  
  
  /* Social footer */
  
  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }
  
  .disqus-comments {
    margin-right: 30px;
  }
  
  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }
  
  #disqus_thread {
    margin-top: 30px;
  }
  
  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }
  
  .article-sharing a:hover {
    border-bottom: none;
  }
  
  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }
  
  .subscribe p {
    margin-bottom: 0.5em;
  }
  
  
  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }
  
  
  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }
  
  .custom p {
    margin-bottom: 0.5em;
  }
  
  
  /* Improve display for browsers without grid (IE/Edge <= 15) */
  
  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }
  
  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }
  
  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }
  
  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }
  
  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }
  
  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }
  
  
  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }
  
  .downlevel .footnotes ol {
    padding-left: 13px;
  }
  
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }
  
  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }
  
  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }
  
  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
  
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
  
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }
  
  </style>
  
  <script type="application/javascript">
  
  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }
  
  // show body when load is complete
  function on_load_complete() {
  
    // set body to visible
    document.body.style.visibility = 'visible';
  
    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }
  
    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }
  
  function init_distill() {
  
    init_common();
  
    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);
  
    // create d-title
    $('.d-title').changeElementType('d-title');
  
    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);
  
    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();
  
    // move posts container into article
    $('.posts-container').appendTo($('d-article'));
  
    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');
  
    // create d-bibliography
    var bibliography = $('<d-bibliography></d-bibliography>');
    $('#distill-bibliography').wrap(bibliography);
  
    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;
  
    // replace citations with <d-cite>
    $('.citation').each(function(i, val) {
      appendix = true;
      var cites = $(this).attr('data-cites').split(" ");
      var dt_cite = $('<d-cite></d-cite>');
      dt_cite.attr('key', cites.join());
      $(this).replaceWith(dt_cite);
    });
    // remove refs
    $('#refs').remove();
  
    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();
  
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-toc a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });
  
    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');
  
    // replace code blocks with d-code
    $('pre>code').each(function(i, val) {
      var code = $(this);
      var pre = code.parent();
      var clz = "";
      var language = pre.attr('class');
      if (language) {
        // map unknown languages to "clike" (without this they just dissapear)
        if ($.inArray(language, ["bash", "clike", "css", "go", "html",
                                 "javascript", "js", "julia", "lua", "markdown",
                                 "markup", "mathml", "python", "svg", "xml"]) == -1)
          language = "clike";
        language = ' language="' + language + '"';
        var dt_code = $('<d-code block' + language + clz + '></d-code>');
        dt_code.text(code.text());
        pre.replaceWith(dt_code);
      } else {
        code.addClass('text-output').unwrap().changeElementType('pre');
      }
    });
  
    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {
  
      // capture layout
      var layout = $(this).attr('data-layout');
  
      // apply layout to markdown level block elements
      var elements = $(this).children().not('d-code, pre.text-output, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });
  
  
      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });
  
    // load distill framework
    load_distill_framework();
  
    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {
  
      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;
  
      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');
  
      // table of contents
      if (have_authors) // adjust border if we are in authors
        $('.d-toc').parent().addClass('d-article-with-toc');
  
      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');
  
      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }
  
      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');
  
      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");
  
      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }
  
       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }
  
      // inject pre code styles (can't do this with a global stylesheet b/c a shadow root is used)
      $('d-code').each(function(i, val) {
        var style = document.createElement('style');
        style.innerHTML = 'pre code { padding-left: 10px; font-size: 12px; border-left: 2px solid rgba(0,0,0,0.1); } ' +
                          '@media(min-width: 768px) { pre code { padding-left: 18px; font-size: 14px; } }';
        if (this.shadowRoot)
          this.shadowRoot.appendChild(style);
      });
  
      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();
  
      // clear polling timer
      clearInterval(tid);
  
      // show body now that everything is ready
      on_load_complete();
    }
  
    var tid = setInterval(distill_post_process, 50);
    distill_post_process();
  
  }
  
  function init_downlevel() {
  
    init_common();
  
     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));
  
    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
  
    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();
  
    // remove toc
    $('.d-toc-header').remove();
    $('.d-toc').remove();
    $('.d-toc-separator').remove();
  
    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });
  
  
    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);
  
    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);
  
    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();
  
    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();
  
    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));
  
    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });
  
    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));
  
    $('body').addClass('downlevel');
  
    on_load_complete();
  }
  
  
  function init_common() {
  
    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};
  
        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });
  
        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);
  
    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});
  
    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });
  
      }
    });
  
    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });
  
    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }
  
    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');
  
    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");
  
    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();
  
    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }
  
  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });
  
  </script>
  
  <!--/radix_placeholder_distill-->
  <script src="advi-vs-mcmc_files/jquery-1.11.3/jquery.min.js"></script>
  <script src="advi-vs-mcmc_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="advi-vs-mcmc_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="advi-vs-mcmc_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"ADVI vs MCMC","description":"Comparing the performance of models fitted to vegetation postfire recovery data using ADVI and MCMC","authors":[{"author":"Glenn Moncrieff","authorURL":{},"affiliation":"&nbsp;","affiliationURL":"#"}],"publishedDate":"2020-08-11T00:00:00.000+02:00","citationText":"Moncrieff, 2020"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>ADVI vs MCMC</h1>
<p><p>Comparing the performance of models fitted to vegetation postfire recovery data using ADVI and MCMC</p></p>
</div>

<div class="d-byline">
  Glenn Moncrieff true 
  
<br/>08-11-2020
</div>

<div class="d-article">
<p>Markov Chain Monte Carlo (MCMC) is the workhorse of modern statistics. Efficient implementations in languages such as <a href="Stanhttps://mc-stan.org/">Stan</a>, <a href="http://mcmc-jags.sourceforge.net/">JAGS</a>, and <a href="https://docs.pymc.io/">PyMC3</a> and many others mean that nowadays we can simply focus on the statistical model and ecological problems we are interested in and leave the estimation of posterior probabilities to be worked out by the MCMC sampler. There is, however, one MAJOR drawback to MCMC</p>
<p>IT. IS. SLOW.</p>
<p>I mean, when you understand what it is really doing under the hood it is actually doing this really, really fast. It is plenty fast for the majority of analyses - those that do not involve estimating 1000s of parameters. But it does not feel that way when you are trying to fit a model with a parameter for every sites on a large spatial grid or every point in a long time-series.</p>
<p>A project that I have been working on for a few years involves estimating the postfire recovery of vegetation in the Cape Floristic Region (CFR) of South Africa. Objectivity the most beautiful vegetation on earth</p>
<figure>
<img src="IMG_7750.jpeg" alt="" /><figcaption>Cape Floristic Region</figcaption>
</figure>
<p>The details are given in <span class="citation" data-cites="slingsby_near-real_2020 wilson_climatic_2015">(Slingsby, Moncrieff, and Wilson <a href="#ref-slingsby_near-real_2020" role="doc-biblioref">2020</a>; Wilson, Latimer, and Silander <a href="#ref-wilson_climatic_2015" role="doc-biblioref">2015</a>)</span>, but in short what we do is estimate the age of a site by calculating the years since the last fire. We then fit a curve to model the recovery of vegetation (measured using NDVI) as a function of it’s age. For this we use a negative exponential curve with the following form:</p>
<p><span class="math display">\[\mu_{i,t}=\alpha_i+\gamma_i\Big(1-e^{-\frac{age_{i,t}}{\lambda_i}}\Big)\]</span></p>
<p>where <span class="math inline">\(\mu_{i,t}\)</span> is the expected NDVI for site <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span></p>
<p>The observed greenness <span class="math inline">\(NDVI_{i,t}\)</span> is assumed to follow a normal distribution with mean <span class="math inline">\(\mu_{i,t}\)</span> <span class="math display">\[NDVI_{i,t}\sim\mathcal{N}(\mu_{i,t},\sigma_)\]</span></p>
<p>An additional level models the parameters of the negative exponential curve as a function of environmental variables. This means that sites with similar environmental conditions should have similar recovery curves. The full model also includes a sinusoidal term to capture seasonal variation, but lets keep it simple here.</p>
<p>To fit this model, we must estimate multiple parameters for every timestep and every pixel in the landscape on a 250m grid. That ends up at 1440000 * n parameters * t timesteps for the 90 000 km2 of the CFR. As you can imagine the model takes a VERY long time to fit using MCMC (around 2 weeks).</p>
<h2 id="mcmc">MCMC</h2>
<p>To get a feel for this problem I will fit the model using MCMC to a small sample of sites from across the region using Stan and R.</p>
<p>Lets load up the libraries we need</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
library(cmdstanr)
library(posterior)
library(bayesplot)
library(dplyr)
library(tidyr)
library(stringr)
library(knitr)
library(ggplot2)
color_scheme_set(&quot;brightblue&quot;)
set.seed(83)</code></pre>
</div>
<p>and pull in the data for some plots</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
#read raw data
postfire &lt;- read.csv(&quot;postfire.csv&quot;)
#tidy up
postfire &lt;- postfire %&gt;%
  filter(ND&gt;0) %&gt;% #remove impossible NDVI values
  filter(nid %in% as.numeric(sample(levels(as.factor(postfire$nid)),50))) %&gt;% #subset plots
  mutate(age=DA/365.23) %&gt;% #convert age from days to years
  select(age=age,nd=ND,pid=nid,env1=map,env2=tmax01) %&gt;%
  mutate(pid = as.numeric(as.factor(pid))) %&gt;%
  mutate(env1 = (env1 - mean(env1))/sd(env1),env2 = (env2 - mean(env2))/sd(env2)) #standardize env variables

#plots level data on env conditions
postfire_grp &lt;- postfire %&gt;%
  group_by(pid) %&gt;%
  summarise(envg1 = max(env1),envg2 = max(env2))

#prep data for stan
postfire_data &lt;- list(N = nrow(postfire),
                     J= nrow(postfire_grp),
                     nd=postfire$nd,
                     age= postfire$age,
                     pid=postfire$pid,
                     envg1 = postfire_grp$envg1,
                     envg2 = postfire_grp$envg2)

kable(head(postfire))</code></pre>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">age</th>
<th style="text-align: right;">nd</th>
<th style="text-align: right;">pid</th>
<th style="text-align: right;">env1</th>
<th style="text-align: right;">env2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">14.04594</td>
<td style="text-align: right;">0.4462</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5622957</td>
<td style="text-align: right;">-0.8759055</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.08975</td>
<td style="text-align: right;">0.4667</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5622957</td>
<td style="text-align: right;">-0.8759055</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.13356</td>
<td style="text-align: right;">0.4806</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5622957</td>
<td style="text-align: right;">-0.8759055</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.17737</td>
<td style="text-align: right;">0.4789</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5622957</td>
<td style="text-align: right;">-0.8759055</td>
</tr>
<tr class="odd">
<td style="text-align: right;">14.22118</td>
<td style="text-align: right;">0.4582</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5622957</td>
<td style="text-align: right;">-0.8759055</td>
</tr>
<tr class="even">
<td style="text-align: right;">14.26498</td>
<td style="text-align: right;">0.4628</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.5622957</td>
<td style="text-align: right;">-0.8759055</td>
</tr>
</tbody>
</table>
</div>
<p>We have <code>age</code> in years, a plot identifier <code>pid</code>. the observed ndvi <code>nd</code> and two plot level environmental variable <code>env1</code>, which is mean annual precipitation, and <code>env2</code>, which is the summer maximum temperature.</p>
<p>Lets load up our Stan model which codes the model described above. This is not a particularly clever or efficient way of coding the model, but it is nice and readable and works fine on this example dataset</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
model &lt;- cmdstan_model(&#39;firemodel_predict.stan&#39;, compile = TRUE)
model$print()</code></pre>
<pre><code>
data {
  int&lt;lower=0&gt; N;
  int&lt;lower=0&gt; J;
  int&lt;lower=1,upper=J&gt; pid[N];
  vector[N] age;
  vector[N] nd;
  vector[J] envg1;
  vector[J] envg2;
  
}
parameters {
  vector[J] alpha;
  vector[J] gamma;
  vector[J] lambda;
  real alpha_mu;
  real gamma_b1;
  real gamma_b2;
  real lambda_b1;
  real lambda_b2;
  real&lt;lower=0&gt; tau_sq;
  real&lt;lower=0&gt; gamma_tau_sq;
  real&lt;lower=0&gt; lambda_tau_sq;
  real&lt;lower=0&gt; alpha_tau_sq;
}

transformed parameters {
  vector[N] mu;
  vector[J] gamma_mu;
  vector[J] lambda_mu;
  real tau = sqrt(tau_sq);
  real gamma_tau = sqrt(gamma_tau_sq);
  real lambda_tau = sqrt(lambda_tau_sq);
  real alpha_tau = sqrt(alpha_tau_sq);
  
  for (j in 1:J){
    gamma_mu[j] = (envg1[j]*gamma_b1) + (envg2[j]*gamma_b2);
    lambda_mu[j] = (envg1[j]*lambda_b1) + (envg2[j]*lambda_b2);
  }
  
  for (i in 1:N){
    mu[i] = exp(alpha[pid[i]])+exp(gamma[pid[i]])-exp(gamma[pid[i]])*exp(-(age[i]/exp(lambda[pid[i]])));
  }
}

model {

  tau ~  inv_gamma(0.01, 0.01);
  gamma_tau ~ inv_gamma(0.01, 0.01);
  lambda_tau ~ inv_gamma(0.01, 0.01);
  alpha_tau ~ inv_gamma(0.01, 0.01);
  
  alpha_mu ~ normal(0.15,3);
  gamma_b1 ~ normal(0,3);
  gamma_b2 ~ normal(0,3);
  lambda_b1 ~ normal(0,3);
  lambda_b2 ~ normal(0,3);
  

  alpha ~ normal(alpha_mu, alpha_tau);
  gamma ~ normal(gamma_mu,gamma_tau); 
  lambda ~ normal(lambda_mu,lambda_tau); 

  nd ~ normal(mu, tau);
  
}

generated quantities {
  vector[N] nd_new;
  
  for (n in 1:N){
    nd_new[n] = normal_rng(mu[n], tau);
  }
}</code></pre>
</div>
<p>We then fit the model</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
fit_mcmc &lt;- model$sample(
  data = postfire_data,
  seed = 123,
  refresh=500,
  chains = 2,
  parallel_chains = 2,
  iter_warmup = 1000,
  iter_sampling = 2000
)</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>and do the normal checks to see that our MCMC sampler behaved itself (skipped here). If we check our posterior traces for some parameters they looks like healthy, hairy caterpillars</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
mcmc_trace(fit_mcmc$draws(c(&quot;tau&quot;,&quot;alpha_mu&quot;)))</code></pre>
<p><img src="advi-vs-mcmc_files/figure-html5/mcmc_check2-1.png" width="624" /></p>
</div>
<p>The crux here is how long it takes to run this sampler</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
fit_mcmc$time()$total</code></pre>
<pre><code>
[1] 2954.735</code></pre>
</div>
<p>2954 seconds or 50 minutes to do just 50 sites. Remember the full dataset is 1440000 sites. While there are a couple of good options to improve the efficiency of this model, and <a href="https://mc-stan.org/users/documentation/case-studies/reduce_sum_tutorial.html">neat new ways</a> of parallelizing within-chain operations in Stan, MCMC is always going to take a long time for this kind of task. Wouldn’t it be great if there was another, faster way of estimating the full posterior….</p>
<h2 id="variational-inference">Variational Inference</h2>
<p>Variational inference (VI) is a method for approximating the posterior that has been around for a while. VI is much, much faster than MCMC, and can scale to very large datasets. The major drawback that has limited it’s use is that model-specific calculations and derivations are required to implement VI. The joke is that deriving your VI algorithm is what you do while you wait for your MCMC sampler to finish. But there has been some exciting activity in VI research lately that has made it possible to automate the process of deriving scalable variational inference algorithms for a wide class of models. I am going to skip the details here, but these publications are worth digging into if you are interested in this <span class="citation" data-cites="kucukelbir_automatic_2015 kucukelbir_automatic_2017 blei_variational_2017">(Kucukelbir et al. <a href="#ref-kucukelbir_automatic_2015" role="doc-biblioref">2015</a>, <a href="#ref-kucukelbir_automatic_2017" role="doc-biblioref">2017</a>; Blei, Kucukelbir, and McAuliffe <a href="#ref-blei_variational_2017" role="doc-biblioref">2017</a>)</span>.</p>
<p>The salient point is that Automatic Differentiation Variational Inference (ADVI) turns the task of computing a posterior into an optimization problem - we simply need to use an optimization algorithm like stochastic gradient ascent (SGA) to maximize a loss function. With SGA we can also feed our data in as mini-batches (subsamples), which adds the potential to scale to very large datasets. The best part of all of this is that ADVI is already implemented in a number of probabilistic programming languages, including Stan. All we need is to change one line of code and we can fit the same Stan model using ADVI:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
fit_vb &lt;- model$variational(
  data = postfire_data,
  adapt_engaged=FALSE,
  eta=0.1,
  tol_rel_obj = 0.001,
  seed = 123)</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>How long did that take?</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
fit_vb$time()$total</code></pre>
<pre><code>
[1] 28.3975</code></pre>
</div>
<p>28 seconds, or about 100 times faster than MCMC. In separate tests I have tried it doesn’t seem to take much longer on the full dataset.</p>
<h2 id="ok-whats-the-catch">Ok, what’s the catch?</h2>
<p>ADVI, like all of variational inference, is an approximate inference technique; whereas MCMC, if done right, will converge to the exact posterior. ADVI assumes no dependency (i.e. zero correlations) between parameter distributions, if this is not the case, ADVI can underestimate variances in the parameter distributions (though there are extensions that can help with this).</p>
<p>In practice what this means that if you want to use ADVI it is a good idea to compare posteriors estimated using ADVI and MCMC, if this is possible. For our model the ADVI and MCMC parameter estimates are pretty close</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
bayesplot_grid(
  mcmc_dens(fit_vb$draws(&quot;tau&quot;)),
  mcmc_dens(fit_mcmc$draws(&quot;tau&quot;)),
  titles = c(&quot;MCMC&quot;, &quot;ADVI&quot;),
  xlim = c(0.04, 0.07)
)</code></pre>
<p><img src="advi-vs-mcmc_files/figure-html5/p1-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
bayesplot_grid(
  mcmc_dens(fit_vb$draws(&quot;alpha_mu&quot;)),
  mcmc_dens(fit_mcmc$draws(&quot;alpha_mu&quot;)),
  titles = c(&quot;MCMC&quot;, &quot;ADVI&quot;),
  xlim = c(-2.5, 0)
)</code></pre>
<p><img src="advi-vs-mcmc_files/figure-html5/p2-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
bayesplot_grid(
  mcmc_dens(fit_vb$draws(c(&quot;gamma_b2&quot;,&quot;gamma_b1&quot;,&quot;lambda_b1&quot;,&quot;lambda_b2&quot;))),
  mcmc_dens(fit_mcmc$draws(c(&quot;gamma_b2&quot;,&quot;gamma_b1&quot;,&quot;lambda_b1&quot;,&quot;lambda_b2&quot;))),
  titles = c(&quot;MCMC&quot;, &quot;ADVI&quot;),
  xlim = c(-1, 1),
  grid_args=list(ncol=2)
)</code></pre>
<p><img src="advi-vs-mcmc_files/figure-html5/p3-1.png" width="624" /></p>
</div>
<p>But what we are really interested in with this model is the posterior predictions of observed NDVI. We want to use the model to estimate future NDVI and compare to observations. The idea is that this comparison will allow us to diagnose sites where NDVI is going off-track, and there may be some underlying ecological problem (see <span class="citation" data-cites="slingsby_near-real_2020">(Slingsby, Moncrieff, and Wilson <a href="#ref-slingsby_near-real_2020" role="doc-biblioref">2020</a>)</span> for more details). Even if ADVI is not exact, if it returns posterior predictive intervals very close to MCMC ina fraction of the time it would mean we could scale this idea to very large areas.</p>
<p>Lets try this on our data. First lets extract the posterior predictive intervals that we generated in the MCMC and ADVI model and wrangle them into a neat data frame</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
#posterior predictive
stan_vb &lt;- fit_vb$summary(&quot;nd_new&quot;,&quot;mean&quot;,&quot;quantile2&quot;)
stan_mcmc &lt;- fit_mcmc$summary(&quot;nd_new&quot;,&quot;mean&quot;,&quot;quantile2&quot;)
#add observed data
stan_vb$method &lt;- &quot;ADVI&quot;
stan_vb$age &lt;- postfire_data$age
stan_vb$pid &lt;- postfire_data$pid
stan_vb$nd &lt;- postfire_data$nd
stan_mcmc$method &lt;- &quot;MCMC&quot;
stan_mcmc$age &lt;- postfire_data$age
stan_mcmc$pid &lt;- postfire_data$pid
stan_mcmc$nd &lt;- postfire_data$nd
#wrangle
stan_ndvi &lt;- rbind(stan_vb,stan_mcmc) %&gt;%
  select(age=age,NDVI=nd,pid,mean,upper=q95,lower=q5,method) %&gt;%
  filter(pid %in% as.numeric(sample(levels(as.factor(stan_vb$pid)),6)))
stan_ndvi$method &lt;- ordered(stan_ndvi$method)</code></pre>
</div>
<p>When we make this comparison, the posterior predictive intervals from ADVI and MCMC are almost identical</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
ggplot(data=stan_ndvi,aes(x=age)) +
  geom_line(aes(y=mean,lty=method),colour=&quot;blue&quot;) +
  geom_line(aes(y=NDVI),colour=&quot;black&quot;,lwd=0.5,alpha=0.3) +
  geom_ribbon(aes(ymin=lower,ymax=upper,fill=method),alpha=0.5)+
  facet_wrap(~pid) +
  xlim(c(0,20))+
  labs(x=&quot;time since fire (years)&quot;,y=&quot;NDVI&quot;) +
  theme_bw()</code></pre>
<p><img src="advi-vs-mcmc_files/figure-html5/plot-1.png" width="624" /></p>
</div>
<p>This is great news. If we were trying to make inferences about ecological process from parameters estimates, we would want an exact method like MCMC <span class="citation" data-cites="wilson_climatic_2015">(Wilson, Latimer, and Silander <a href="#ref-wilson_climatic_2015" role="doc-biblioref">2015</a>)</span>. But for the purposes of monitoring vegetation we are not interested in this - we only want a method that give us a good-enough fit and that is practical to deploy. ADVI fits the bill here, and we are excited to see where we go with the newfound ability to scale our analyses to bigger areas and finer scales.</p>
<div id="refs" class="references" role="doc-bibliography">
<div id="ref-blei_variational_2017">
<p>Blei, David M., Alp Kucukelbir, and Jon D. McAuliffe. 2017. “Variational Inference: A Review for Statisticians.” <em>Journal of the American Statistical Association</em> 112 (518): 859–77.</p>
</div>
<div id="ref-kucukelbir_automatic_2015">
<p>Kucukelbir, Alp, Rajesh Ranganath, Andrew Gelman, and David M. Blei. 2015. “Automatic Variational Inference in Stan.” <em>arXiv:1506.03431 [Stat]</em>, June. <a href="http://arxiv.org/abs/1506.03431">http://arxiv.org/abs/1506.03431</a>.</p>
</div>
<div id="ref-kucukelbir_automatic_2017">
<p>Kucukelbir, Alp, Dustin Tran, Rajesh Ranganath, Andrew Gelman, and David M. Blei. 2017. “Automatic Differentiation Variational Inference.” <em>The Journal of Machine Learning Research</em> 18 (1): 430–74.</p>
</div>
<div id="ref-slingsby_near-real_2020">
<p>Slingsby, Jasper A., Glenn R. Moncrieff, and Adam M. Wilson. 2020. “Near-Real Time Forecasting and Change Detection for an Open Ecosystem with Complex Natural Dynamics.” <em>ISPRS Journal of Photogrammetry and Remote Sensing</em> 166 (August): 15–25. <a href="https://doi.org/10.1016/j.isprsjprs.2020.05.017">https://doi.org/10.1016/j.isprsjprs.2020.05.017</a>.</p>
</div>
<div id="ref-wilson_climatic_2015">
<p>Wilson, Adam M, Andrew M Latimer, and John A Jr Silander. 2015. “Climatic Controls on Ecosystem Resilience: Postfire Regeneration in the Cape Floristic Region of South Africa.” <em>Proceedings of the National Academy of Sciences of the United States of America</em> 112 (29): 9058–63. <a href="https://doi.org/10.1073/pnas.1416710112">https://doi.org/10.1073/pnas.1416710112</a>.</p>
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<script id="distill-bibliography" type="text/bibtex">

@article{blei_variational_2017,
	title = {Variational inference: {A} review for statisticians},
	volume = {112},
	shorttitle = {Variational inference},
	number = {518},
	journal = {Journal of the American statistical Association},
	author = {Blei, David M. and Kucukelbir, Alp and McAuliffe, Jon D.},
	year = {2017},
	pages = {859--877}
}

@article{kucukelbir_automatic_2017,
	title = {Automatic differentiation variational inference},
	volume = {18},
	number = {1},
	journal = {The Journal of Machine Learning Research},
	author = {Kucukelbir, Alp and Tran, Dustin and Ranganath, Rajesh and Gelman, Andrew and Blei, David M.},
	year = {2017},
	pages = {430--474}
}

@article{kucukelbir_automatic_2015,
	title = {Automatic {Variational} {Inference} in {Stan}},
	url = {http://arxiv.org/abs/1506.03431},
	abstract = {Variational inference is a scalable technique for approximate Bayesian inference. Deriving variational inference algorithms requires tedious model-specific calculations; this makes it difficult to automate. We propose an automatic variational inference algorithm, automatic differentiation variational inference (ADVI). The user only provides a Bayesian model and a dataset; nothing else. We make no conjugacy assumptions and support a broad class of models. The algorithm automatically determines an appropriate variational family and optimizes the variational objective. We implement ADVI in Stan (code available now), a probabilistic programming framework. We compare ADVI to MCMC sampling across hierarchical generalized linear models, nonconjugate matrix factorization, and a mixture model. We train the mixture model on a quarter million images. With ADVI we can use variational inference on any model we write in Stan.},
	urldate = {2020-08-12},
	journal = {arXiv:1506.03431 [stat]},
	author = {Kucukelbir, Alp and Ranganath, Rajesh and Gelman, Andrew and Blei, David M.},
	month = jun,
	year = {2015},
	note = {arXiv: 1506.03431},
	keywords = {Statistics - Machine Learning}
}

@article{slingsby_near-real_2020,
	title = {Near-real time forecasting and change detection for an open ecosystem with complex natural dynamics},
	volume = {166},
	issn = {0924-2716},
	url = {http://www.sciencedirect.com/science/article/pii/S092427162030143X},
	doi = {10.1016/j.isprsjprs.2020.05.017},
	abstract = {Managing fire, water, biodiversity and carbon stocks can greatly benefit from early warning of changes in the state of vegetation. While near-real time tools to detect forest change based on satellite remote sensing exist, these ecosystems have relatively stable natural vegetation dynamics. Open (i.e. non-forest) ecosystems like grasslands, savannas and shrublands are more challenging as they show complex natural dynamics due to factors such as fire, postfire recovery, greater contribution of bare soil to observed vegetation indices, as well as high sensitivity to rainfall and strong seasonality. Tools to aid the management of open ecosystems are desperately required as they dominate much of the globe and harbour substantial biodiversity and carbon. We present an innovative approach that overcomes the difficulties posed by open ecosystems by using a spatio-temporal hierarchical Bayesian model that uses data on climate, topography, soils and fire history to generate ecological forecasts of the expected land surface signal under natural conditions. This allows us to monitor and detect abrupt or gradual changes in the state of an ecosystem in near-real time by identifying areas where the observed vegetation signal has deviated from the expected natural variation. We apply our approach to a case study from the hyperdiverse fire-dependent African shrubland, the fynbos of the Cape Floristic Region, a Global Biodiversity Hotspot and UNESCO World Heritage Site that faces a number of threats to vegetation health and ecosystem function. The case study demonstrates that our approach is useful for identifying a range of change agents such as fire, alien plant species invasions, drought, pathogen outbreaks and clearing of vegetation. We describe and provide our full workflow, including an interactive web application. Our approach is highly versatile, allowing us to collect data on the impacts of change agents for research in ecology and earth system science, and to predict aspects of ecosystem structure and function such as biomass, fire return interval and the influence of vegetation on hydrology.},
	language = {en},
	urldate = {2020-08-12},
	journal = {ISPRS Journal of Photogrammetry and Remote Sensing},
	author = {Slingsby, Jasper A. and Moncrieff, Glenn R. and Wilson, Adam M.},
	month = aug,
	year = {2020},
	keywords = {Ecological forecasting, Fire, Fynbos, Global change, Hierarchical Bayes, Time series},
	pages = {15--25}
}

@article{wilson_climatic_2015,
	title = {Climatic controls on ecosystem resilience: {Postfire} regeneration in the {Cape} {Floristic} {Region} of {South} {Africa}.},
	volume = {112},
	issn = {1091-6490 (Electronic)},
	doi = {10.1073/pnas.1416710112},
	abstract = {Conservation of biodiversity and natural resources in a changing climate requires understanding what controls ecosystem resilience to disturbance. This understanding is especially important in the fire-prone Mediterranean systems of the world. The fire frequency in these systems is sensitive to climate, and recent climate change has resulted in more frequent fires over the last few decades. However, the sensitivity of postfire recovery and biomass/fuel load accumulation to climate is less well understood than fire frequency despite its importance in driving the fire regime. In this study, we develop a hierarchical statistical framework to model postfire ecosystem recovery using satellite-derived observations of vegetation as a function of stand age, topography, and climate. In the Cape Floristic Region (CFR) of South Africa, a fire-prone biodiversity hotspot, we found strong postfire recovery gradients associated with climate resulting in faster recovery in regions with higher soil fertility, minimum July (winter) temperature, and mean January (summer) precipitation. Projections using an ensemble of 11 downscaled Coupled Model Intercomparison Project Phase 5 (CMIP5) general circulation models (GCMs) suggest that warmer winter temperatures in 2080-2100 will encourage faster postfire recovery across the region, which could further increase fire frequency due to faster fuel accumulation. However, some models project decreasing precipitation in the western CFR, which would slow recovery rates there, likely reducing fire frequency through lack of fuel and potentially driving local biome shifts from fynbos shrubland to nonburning semidesert vegetation. This simple yet powerful approach to making inferences from large, remotely sensed datasets has potential for wide application to modeling ecosystem resilience in disturbance-prone ecosystems globally.},
	number = {29},
	journal = {Proceedings of the National Academy of Sciences of the United States of America},
	author = {Wilson, Adam M and Latimer, Andrew M and Silander, John A Jr},
	year = {2015},
	pmid = {26150521},
	pages = {9058--9063}
}
</script>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
